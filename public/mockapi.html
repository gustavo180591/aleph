<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>ALEPH ‚Äì Mock Preview</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    /* -----------------------------
      THEME + FONT SCALE (Persistente)
    ------------------------------ */
    :root{
      --font-scale: 1;
      --bg: #ffffff;
      --text: #0f172a;
      --muted: #475569;
      --card: #f1f5f9;
      --card2: #e2e8f0;
      --border: #cbd5e1;
      --primary: #2563eb;
      --primary-2:#1d4ed8;
      --danger: #dc2626;
      --success:#16a34a;
      --shadow: 0 10px 30px rgba(2,6,23,.08);
      --radius: 16px;
      --radius2: 22px;
      --max: 1160px;
    }
    html.dark{
      --bg: #0b1220;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --card: #111b2f;
      --card2: #0f172a;
      --border: #223252;
      --primary:#60a5fa;
      --primary-2:#3b82f6;
      --danger:#f87171;
      --success:#34d399;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    html{
      font-size: calc(16px * var(--font-scale));
    }
    *{ box-sizing: border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
    }
    a{ color: inherit; text-decoration: none; }
    button, input{
      font: inherit;
    }

    /* -----------------------------
      LAYOUT
    ------------------------------ */
    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 0 1rem;
    }
    .hidden{ display:none !important; }
    .muted{ color: var(--muted); }

    /* -----------------------------
      SPLASH (Duolingo-like feel)
    ------------------------------ */
    #splash{
      position: fixed;
      inset: 0;
      display:flex;
      align-items:center;
      justify-content:center;
      background: var(--bg);
      z-index: 9999;
    }
    .splash-card{
      width: min(520px, 92vw);
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--card), var(--bg));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 2.2rem 1.6rem;
      text-align:center;
    }
    .brandmark{
      width: 88px;
      height: 88px;
      margin: 0 auto 1rem;
      display:grid;
      place-items:center;
      border-radius: 28px;
      border: 1px solid var(--border);
      background: var(--card2);
      box-shadow: 0 10px 18px rgba(2,6,23,.08);
      user-select:none;
      overflow:hidden;
    }
    .brandmark svg{ width:56px; height:56px; }
    .splash-title{
      font-size: 2rem;
      letter-spacing: .02em;
      margin: .1rem 0 .3rem;
      font-weight: 800;
      opacity: 0;
      transform: translateY(8px);
      animation: titleIn .7s ease forwards;
      animation-delay: .55s;
    }
    .splash-sub{
      margin:0;
      color: var(--muted);
      opacity:.95;
      font-size: 1rem;
    }
    .bar{
      width: 70%;
      height: 10px;
      margin: 1.4rem auto 0;
      border-radius: 999px;
      background: var(--card2);
      border: 1px solid var(--border);
      overflow:hidden;
    }
    .bar > i{
      display:block;
      height:100%;
      width: 0%;
      background: linear-gradient(90deg, var(--primary), var(--primary-2));
      animation: load 1.25s ease forwards;
    }
    @keyframes load { to { width: 100%; } }
    @keyframes titleIn { to { opacity:1; transform: translateY(0); } }

    /* -----------------------------
      NAVBAR
    ------------------------------ */
    header{
      position: sticky;
      top:0;
      z-index: 50;
      background: rgba(255,255,255,.75);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
    }
    html.dark header{
      background: rgba(11,18,32,.72);
    }
    .nav{
      display:flex;
      align-items:center;
      justify-content: space-between;
      padding: .85rem 0;
      gap: 1rem;
    }
    .brand{
      display:flex;
      align-items:center;
      gap: .65rem;
      min-width: 180px;
    }
    .brand-badge{
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      border: 1px solid var(--border);
      background: var(--card);
    }
    .brand-name{
      font-weight: 900;
      letter-spacing: .03em;
    }
    .menu{
      display:flex;
      gap: 1rem;
      align-items:center;
    }
    .menu a{
      padding: .45rem .6rem;
      border-radius: 12px;
      color: var(--muted);
      font-weight: 600;
    }
    .menu a.active{
      background: var(--card);
      color: var(--text);
      border: 1px solid var(--border);
    }
    .menu a:hover{
      background: var(--card);
      color: var(--text);
    }

    .right{
      display:flex;
      align-items:center;
      gap: .6rem;
      min-width: 240px;
      justify-content:flex-end;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:.5rem;
      padding: .45rem .65rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      font-weight: 700;
    }
    .chip small{
      font-weight: 600;
      color: var(--muted);
    }
    .btn{
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      padding: .55rem .85rem;
      border-radius: 14px;
      font-weight: 800;
      cursor:pointer;
    }
    .btn.primary{
      background: linear-gradient(180deg, var(--primary), var(--primary-2));
      border-color: transparent;
      color: white;
    }
    .btn.ghost{
      background: transparent;
    }
    .btn:hover{ filter: brightness(0.98); }
    .btn:active{ transform: translateY(1px); }

    /* Profile dropdown */
    .dropdown{
      position: relative;
    }
    .dropdown-panel{
      position:absolute;
      top: 110%;
      right: 0;
      width: 260px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: var(--bg);
      box-shadow: var(--shadow);
      padding: .55rem;
      display:none;
    }
    .dropdown-panel.open{ display:block; }
    .dropdown-panel button{
      width:100%;
      text-align:left;
      background: transparent;
      border: none;
      padding: .65rem .7rem;
      border-radius: 12px;
      cursor:pointer;
      color: var(--text);
      font-weight: 700;
    }
    .dropdown-panel button:hover{
      background: var(--card);
    }

    /* Mobile */
    .hamb{
      display:none;
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--card);
      cursor:pointer;
      place-items:center;
    }
    .hamb span{
      display:block;
      width: 20px;
      height: 2px;
      background: var(--text);
      position: relative;
    }
    .hamb span::before,
    .hamb span::after{
      content:"";
      position:absolute;
      left:0;
      width: 20px;
      height:2px;
      background: var(--text);
    }
    .hamb span::before{ top:-7px; }
    .hamb span::after{ top: 7px; }

    @media (max-width: 860px){
      .menu{ display:none; }
      .hamb{ display:grid; }
      .brand{ min-width: auto; }
      .right{ min-width: auto; }
    }
    .mobile-menu{
      display:none;
      border-top: 1px solid var(--border);
      padding: .75rem 0 1rem;
    }
    .mobile-menu.open{ display:block; }
    .mobile-menu a{
      display:block;
      padding: .7rem .5rem;
      border-radius: 12px;
      color: var(--muted);
      font-weight: 700;
    }
    .mobile-menu a.active{
      color: var(--text);
      background: var(--card);
      border: 1px solid var(--border);
    }

    /* -----------------------------
      PAGES
    ------------------------------ */
    main{
      padding: 1.8rem 0 3.2rem;
    }
    .hero{
      margin-top: .6rem;
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      background: linear-gradient(180deg, var(--card), var(--bg));
      box-shadow: var(--shadow);
      padding: 1.4rem;
      display:grid;
      gap: .35rem;
    }
    .hero h1{
      margin:0;
      font-size: 1.8rem;
      letter-spacing: .01em;
    }
    .hero p{ margin:.25rem 0 0; color: var(--muted); }

    .grid2{
      margin-top: 1rem;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 1rem;
    }
    @media (max-width: 980px){ .grid2{ grid-template-columns: 1fr; } }

    .panel{
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      background: var(--bg);
      box-shadow: var(--shadow);
      padding: 1.1rem;
    }
    .panel h2{
      margin:0 0 .4rem;
      font-size: 1.2rem;
    }
    .panel p{ margin:.35rem 0; color: var(--muted); }

    .cards{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    .card{
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      background: var(--card);
      box-shadow: 0 8px 22px rgba(2,6,23,.08);
      padding: 1rem;
      cursor:pointer;
      transition: transform .15s ease, filter .15s ease;
      display:flex;
      gap: .9rem;
      align-items:center;
    }
    html.dark .card{ box-shadow: 0 8px 22px rgba(0,0,0,.3); }
    .card:hover{ transform: translateY(-2px); filter: brightness(1.01); }
    .logo{
      width: 56px;
      height: 56px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: var(--bg);
      display:grid;
      place-items:center;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .logo img{ width: 100%; height: 100%; object-fit: contain; }
    .card strong{ display:block; }
    .card small{ color: var(--muted); font-weight: 650; }

    .auth{
      max-width: 520px;
      margin: 1rem auto 0;
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      background: var(--bg);
      box-shadow: var(--shadow);
      padding: 1.2rem;
    }
    .auth-header{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: .85rem;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: .5rem;
      border: 1px solid var(--border);
      background: var(--card);
      padding: .35rem .6rem;
      border-radius: 999px;
      font-weight: 800;
    }
    .form{
      display:grid;
      gap: .7rem;
      margin-top: .5rem;
    }
    label{
      display:block;
      font-weight: 800;
      font-size: .9rem;
      margin-bottom: .25rem;
    }
    input{
      width:100%;
      padding: .7rem .8rem;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      outline: none;
    }
    input:focus{
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(37,99,235,.15);
    }
    html.dark input:focus{
      box-shadow: 0 0 0 4px rgba(96,165,250,.16);
    }

    .row{
      display:flex;
      gap: .7rem;
    }
    .row > div{ flex: 1; }

    .msg{
      border-radius: 14px;
      padding: .7rem .85rem;
      border: 1px solid var(--border);
      background: var(--card);
      font-weight: 750;
      color: var(--text);
    }
    .msg.error{
      border-color: rgba(220,38,38,.35);
      background: rgba(220,38,38,.08);
      color: var(--danger);
    }
    .msg.success{
      border-color: rgba(22,163,74,.35);
      background: rgba(22,163,74,.10);
      color: var(--success);
    }

    .link{
      color: var(--primary);
      font-weight: 900;
      cursor:pointer;
    }
    .link:hover{ text-decoration: underline; }

    /* Settings */
    .settings-grid{
      display:grid;
      gap: .8rem;
      margin-top: .8rem;
    }
    .setting{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: .8rem;
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: .8rem;
      background: var(--card);
    }
    .seg{
      display:flex;
      gap: .4rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .seg button{
      padding: .5rem .65rem;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: var(--bg);
      cursor:pointer;
      font-weight: 900;
      color: var(--text);
      min-width: 54px;
      text-align:center;
    }
    .seg button.active{
      background: linear-gradient(180deg, var(--primary), var(--primary-2));
      color: white;
      border-color: transparent;
    }

    /* Footer-ish */
    .fine{
      margin-top: 1.6rem;
      text-align:center;
      color: var(--muted);
      font-weight: 650;
      font-size: .95rem;
    }
  </style>

  <script>
    /* -----------------------------
      APPLY PERSISTED THEME + FONT
    ------------------------------ */
    (function bootPrefs(){
      const savedTheme = localStorage.getItem("aleph_theme");
      const savedScale = localStorage.getItem("aleph_fontScale");

      if(savedTheme){
        if(savedTheme === "dark") document.documentElement.classList.add("dark");
      }else{
        // default to OS preference
        if(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches){
          document.documentElement.classList.add("dark");
          localStorage.setItem("aleph_theme","dark");
        }else{
          localStorage.setItem("aleph_theme","light");
        }
      }

      if(savedScale){
        document.documentElement.style.setProperty("--font-scale", savedScale);
      }else{
        localStorage.setItem("aleph_fontScale","1");
        document.documentElement.style.setProperty("--font-scale","1");
      }
    })();
  </script>
</head>

<body>

<!-- SPLASH -->
<section id="splash" aria-label="Pantalla de inicio">
  <div class="splash-card">
    <div class="brandmark" aria-hidden="true">
      <!-- Simple SVG logo -->
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M12 2l8 6v12l-8 2-8-2V8l8-6Z" stroke="currentColor" stroke-width="1.6" opacity=".9"/>
        <path d="M8 14c1.2-2.7 2.6-4.2 4-4.2s2.8 1.5 4 4.2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M7 16h10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" opacity=".8"/>
      </svg>
    </div>
    <div class="splash-title">ALEPH</div>
    <p class="splash-sub">Matem√°tica ‚Ä¢ Programaci√≥n de Sistemas ‚Ä¢ Secundario</p>
    <div class="bar"><i></i></div>
  </div>
</section>

<!-- NAV -->
<header>
  <div class="wrap">
    <div class="nav">
      <div class="brand" role="button" tabindex="0" onclick="Nav.go('home')" aria-label="Ir a Home">
        <div class="brand-badge" aria-hidden="true">üß†</div>
        <div>
          <div class="brand-name">ALEPH</div>
          <div class="muted" style="font-weight:700;font-size:.85rem;">Plataforma Educativa</div>
        </div>
      </div>

      <button class="hamb" id="hamb" aria-label="Abrir men√∫" onclick="Nav.toggleMobile()"><span></span></button>

      <nav class="menu" aria-label="Navegaci√≥n principal">
        <a href="#" data-route="home" class="active" onclick="Nav.go('home');return false;">Home</a>
        <a href="#" data-route="about" onclick="Nav.go('about');return false;">Qui√©nes somos</a>
        <a href="#" data-route="teachers" onclick="Nav.go('teachers');return false;">Docentes</a>
        <a href="#" data-route="contact" onclick="Nav.go('contact');return false;">Contacto</a>
        <a href="#" data-route="alumno" onclick="Nav.go('alumno');return false;">Alumno</a>
      </nav>

      <div class="right">
        <div class="dropdown" id="profileArea">
          <!-- Filled by JS -->
        </div>
      </div>
    </div>

    <div class="mobile-menu" id="mobileMenu" aria-label="Men√∫ m√≥vil">
      <a href="#" data-route="home" class="active" onclick="Nav.go('home');Nav.toggleMobile(false);return false;">Home</a>
      <a href="#" data-route="about" onclick="Nav.go('about');Nav.toggleMobile(false);return false;">Qui√©nes somos</a>
      <a href="#" data-route="teachers" onclick="Nav.go('teachers');Nav.toggleMobile(false);return false;">Docentes</a>
      <a href="#" data-route="contact" onclick="Nav.go('contact');Nav.toggleMobile(false);return false;">Contacto</a>
      <a href="#" data-route="alumno" onclick="Nav.go('alumno');Nav.toggleMobile(false);return false;">Alumno</a>
    </div>
  </div>
</header>

<!-- MAIN -->
<main>
  <div class="wrap">

    <!-- HOME -->
    <section id="page-home">
      <div class="hero">
        <h1>Bienvenido a ALEPH</h1>
        <p>
          ALEPH es una plataforma educativa para <strong>Matem√°tica</strong> y <strong>Programaci√≥n de Sistemas</strong>
          pensada para alumnos de nivel secundario. Acced√©s a contenidos de tu instituci√≥n y personaliz√°s tu experiencia.
        </p>
      </div>

      <div class="grid2">
        <div class="panel">
          <h2>üìê Matem√°tica</h2>
          <p>
            Trabajamos contenidos clave para desarrollar pensamiento l√≥gico y resoluci√≥n de problemas.
            La matem√°tica es base para comprender modelos, estructuras y razonamiento formal.
          </p>
          <p class="muted">
            Vas a encontrar clases ya dictadas, materiales en PDF y planificaci√≥n de lo trabajado.
          </p>
        </div>

        <div class="panel">
          <h2>üíª Programaci√≥n de Sistemas</h2>
          <p>
            Introducci√≥n pr√°ctica y progresiva a herramientas y lenguajes frecuentes:
            <strong>PHP</strong>, <strong>SQL</strong>, <strong>MySQL</strong>, <strong>HTML</strong>, <strong>C</strong>, <strong>PSeInt</strong>, entre otros.
          </p>
          <p class="muted">
            El objetivo es fortalecer l√≥gica, estructuras y buenas pr√°cticas para programar con confianza.
          </p>
        </div>
      </div>

      <div class="fine">
        Tip: Entr√° a <strong>Alumno</strong> para seleccionar tu instituci√≥n e iniciar sesi√≥n.
      </div>
    </section>

    <!-- ABOUT -->
    <section id="page-about" class="hidden">
      <div class="hero">
        <h1>Qui√©nes somos</h1>
        <p>
          ALEPH acompa√±a el aprendizaje de Matem√°tica y Programaci√≥n de Sistemas en el nivel secundario.
          El acceso est√° controlado por instituci√≥n y padr√≥n de DNI.
        </p>
      </div>
      <div class="panel" style="margin-top:1rem;">
        <h2>üìö Prop√≥sito</h2>
        <p>
          Brindar un espacio claro y ordenado para repasar contenidos, acceder a materiales y mejorar la experiencia educativa.
        </p>
        <p class="muted">
          Este mock muestra una previsualizaci√≥n de navegaci√≥n, login/registro y configuraci√≥n (tema y fuente).
        </p>
      </div>
    </section>

    <!-- TEACHERS -->
    <section id="page-teachers" class="hidden">
      <div class="hero">
        <h1>Docentes</h1>
        <p>Informaci√≥n general del equipo docente y referencias.</p>
      </div>

      <div class="panel" style="margin-top:1rem;">
        <h2>üë®‚Äçüè´ Profe Eber</h2>
        <p class="muted">
          Responsable de cargar instituciones y padrones de DNI para habilitar el registro de alumnos.
        </p>
        <div class="msg" style="margin-top:.8rem;">
          Los DNIs son proporcionados por cada instituci√≥n y cargados previamente por el profe Eber.
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="page-contact" class="hidden">
      <div class="hero">
        <h1>Contacto</h1>
        <p>Canales de contacto institucionales (mock).</p>
      </div>

      <div class="panel" style="margin-top:1rem;">
        <h2>üì© Consultas</h2>
        <p class="muted">
          Si ten√©s problemas con tu DNI o acceso, comunicate con el profe Eber a trav√©s de tu instituci√≥n.
        </p>
      </div>
    </section>

    <!-- ALUMNO: Institutions -->
    <section id="page-alumno" class="hidden">
      <div class="hero">
        <h1>Alumno</h1>
        <p>Seleccion√° tu instituci√≥n para continuar con el ingreso.</p>
      </div>

      <div id="instCards" class="cards" aria-label="Instituciones"></div>

      <div class="fine">
        Solo se muestran instituciones <strong>activas</strong>.
      </div>
    </section>

    <!-- AUTH: Login/Register -->
    <section id="page-auth" class="hidden">
      <div class="auth">
        <div class="auth-header">
          <div>
            <div class="pill" id="authInstPill">üè´ Instituci√≥n</div>
            <div class="muted" id="authInstMeta" style="margin-top:.25rem;font-weight:750;"></div>
          </div>
          <button class="btn ghost" onclick="Auth.backToInstitutions()">‚Üê Cambiar instituci√≥n</button>
        </div>

        <div id="authModeTitle" style="font-weight:900;font-size:1.2rem;margin:.2rem 0 .2rem;">Ingresar</div>
        <div class="muted" id="authModeHint" style="font-weight:700;margin-bottom:.75rem;">
          Ingres√° con DNI o Alias y tu contrase√±a.
        </div>

        <div id="authMsg" class="msg hidden"></div>

        <!-- LOGIN FORM -->
        <form id="loginForm" class="form" onsubmit="Auth.submitLogin(event)">
          <div>
            <label>DNI o Alias</label>
            <input id="loginIdentifier" autocomplete="username" placeholder="Ej: 40123456 o juanito" />
          </div>
          <div>
            <label>Contrase√±a</label>
            <input id="loginPassword" type="password" autocomplete="current-password" placeholder="Tu contrase√±a" />
          </div>

          <button class="btn primary" type="submit">Ingresar</button>

          <div class="muted" style="font-weight:750;">
            ¬øNo ten√©s cuenta?
            <span class="link" onclick="Auth.setMode('register')">Registrate</span>
          </div>
        </form>

        <!-- REGISTER FORM -->
        <form id="registerForm" class="form hidden" onsubmit="Auth.submitRegister(event)">
          <div class="row">
            <div>
              <label>Nombre</label>
              <input id="regNombre" placeholder="Ej: Juan" />
            </div>
            <div>
              <label>Apellido</label>
              <input id="regApellido" placeholder="Ej: P√©rez" />
            </div>
          </div>

          <div>
            <label>DNI</label>
            <input id="regDni" placeholder="Ej: 40123456" />
          </div>

          <div>
            <label>Usuario / Alias (IA)</label>
            <input id="regAlias" placeholder="Ej: juanito" />
            <div class="muted" style="font-weight:750;margin-top:.25rem;">
              Este alias ser√° el nombre con el que la IA se dirigir√° a vos.
            </div>
          </div>

          <div>
            <label>Contrase√±a</label>
            <input id="regPass" type="password" placeholder="M√≠nimo 8 caracteres" />
          </div>

          <button class="btn primary" type="submit">Crear cuenta</button>

          <div class="muted" style="font-weight:750;">
            ¬øYa ten√©s cuenta?
            <span class="link" onclick="Auth.setMode('login')">Iniciar sesi√≥n</span>
          </div>
        </form>
      </div>
    </section>

    <!-- SETTINGS -->
    <section id="page-settings" class="hidden">
      <div class="hero">
        <h1>Configuraci√≥n</h1>
        <p>Personaliz√° la interfaz: tema y tama√±o de fuente.</p>
      </div>

      <div class="panel" style="margin-top:1rem;">
        <h2>Preferencias</h2>
        <div class="settings-grid">
          <div class="setting">
            <div>
              <div style="font-weight:900;">Tema</div>
              <div class="muted" style="font-weight:750;">Light / Dark (persistente)</div>
            </div>
            <div class="seg">
              <button id="themeLight" onclick="Prefs.setTheme('light')" type="button">Light</button>
              <button id="themeDark" onclick="Prefs.setTheme('dark')" type="button">Dark</button>
            </div>
          </div>

          <div class="setting">
            <div>
              <div style="font-weight:900;">Tama√±o de fuente</div>
              <div class="muted" style="font-weight:750;">Ajuste global (persistente)</div>
            </div>
            <div class="seg">
              <button data-scale="0.95" onclick="Prefs.setScale('0.95')" type="button">A-</button>
              <button data-scale="1" onclick="Prefs.setScale('1')" type="button">A</button>
              <button data-scale="1.1" onclick="Prefs.setScale('1.1')" type="button">A+</button>
              <button data-scale="1.2" onclick="Prefs.setScale('1.2')" type="button">A++</button>
            </div>
          </div>
        </div>

        <div class="fine">
          Tus preferencias se guardan en <code>localStorage</code>.
        </div>
      </div>
    </section>

  </div>
</main>

<script>
  /* ============================================================
     MOCK API (DB en memoria + delays)
     ============================================================ */

  const MockDB = {
    instituciones: [
      {
        id: "inst-1",
        nombre: "Instituto T√©cnico Posadas",
        provincia: "Misiones",
        ciudad: "Posadas",
        direccion: "Av. Principal 123",
        telefono: "3764-000000",
        email: "contacto@itp.edu.ar",
        sitioWeb: "https://instituto-tecnico-posadas.example",
        logoUrl: "https://via.placeholder.com/160x160.png?text=Escudo+ITP",
        activa: true,
        nivel: "Secundario"
      },
      {
        id: "inst-2",
        nombre: "Escuela Secundaria N¬∫ 5",
        provincia: "Misiones",
        ciudad: "Posadas",
        direccion: "Calle 9 de Julio 456",
        telefono: "3764-111111",
        email: "secretaria@es5.edu.ar",
        sitioWeb: "https://escuela5.example",
        logoUrl: "https://via.placeholder.com/160x160.png?text=Escudo+ES5",
        activa: true,
        nivel: "Secundario"
      },
      {
        id: "inst-3",
        nombre: "Instituto San Jos√©",
        provincia: "Misiones",
        ciudad: "Posadas",
        direccion: "Ruta 12 Km 4",
        telefono: "3764-222222",
        email: "info@sanjose.edu.ar",
        sitioWeb: "https://sanjose.example",
        logoUrl: "https://via.placeholder.com/160x160.png?text=Escudo+SJ",
        activa: true,
        nivel: "Secundario"
      },
      {
        id: "inst-4",
        nombre: "Colegio Demo Inactivo",
        provincia: "Misiones",
        ciudad: "Posadas",
        direccion: "",
        telefono: "",
        email: "",
        sitioWeb: "",
        logoUrl: "https://via.placeholder.com/160x160.png?text=Inactivo",
        activa: false,
        nivel: "Secundario"
      }
    ],

    // Padr√≥n por instituci√≥n (DNIs precargados por Eber)
    padron: [
      { id:"pad-1", institucionId:"inst-1", dni:"40123456", activo:true },
      { id:"pad-2", institucionId:"inst-1", dni:"40999888", activo:true },
      { id:"pad-3", institucionId:"inst-2", dni:"38111222", activo:true },
      { id:"pad-4", institucionId:"inst-2", dni:"39555444", activo:true },
      { id:"pad-5", institucionId:"inst-3", dni:"42123123", activo:true },
    ],

    // Alumnos ya registrados (cuentas)
    alumnos: [
      {
        id:"alu-1",
        institucionId:"inst-1",
        nombre:"Juan",
        apellido:"P√©rez",
        dni:"40123456",
        alias:"juanito",
        password:"12345678",
        activo:true
      }
    ]
  };

  const delay = (ms=450) => new Promise(res => setTimeout(res, ms));

  const MockAPI = {
    async institucionesList(){
      await delay();
      return MockDB.instituciones.filter(i => i.activa);
    },

    async getInstitucion(id){
      await delay(250);
      return MockDB.instituciones.find(i => i.id === id) || null;
    },

    async alumnoLogin({ institucionId, identifier, password }){
      await delay();
      const isDni = /^\d{7,8}$/.test(String(identifier).trim());
      const key = String(identifier).trim().toLowerCase();

      const found = MockDB.alumnos.find(a =>
        a.institucionId === institucionId &&
        (isDni ? a.dni === key : a.alias.toLowerCase() === key)
      );

      if(!found) {
        return { ok:false, error: "DNI/Alias o contrase√±a incorrectos." };
      }
      if(!found.activo) {
        return { ok:false, error: "Tu cuenta est√° inactiva. Comunicate con el profe Eber." };
      }
      if(found.password !== password){
        return { ok:false, error: "DNI/Alias o contrase√±a incorrectos." };
      }

      return {
        ok:true,
        data: {
          id: found.id,
          institucionId: found.institucionId,
          nombre: found.nombre,
          apellido: found.apellido,
          alias: found.alias,
          dni: found.dni
        }
      };
    },

    async alumnoRegister({ institucionId, nombre, apellido, dni, alias, password }){
      await delay();

      // Validaciones b√°sicas
      if(!nombre || nombre.trim().length < 2) return { ok:false, error:"Nombre inv√°lido (m√≠nimo 2 caracteres)." };
      if(!apellido || apellido.trim().length < 2) return { ok:false, error:"Apellido inv√°lido (m√≠nimo 2 caracteres)." };
      if(!/^\d{7,8}$/.test(String(dni).trim())) return { ok:false, error:"DNI inv√°lido (7 u 8 d√≠gitos num√©ricos)." };
      if(!/^[a-zA-Z0-9_-]{3,20}$/.test(String(alias).trim())) return { ok:false, error:"Alias inv√°lido (3‚Äì20, letras/n√∫meros/_/-)." };
      if(!password || String(password).length < 8) return { ok:false, error:"Contrase√±a inv√°lida (m√≠nimo 8 caracteres)." };

      const dniNorm = String(dni).trim();
      const aliasNorm = String(alias).trim().toLowerCase();

      // Regla madre: DNI debe existir en padr√≥n de ESA instituci√≥n
      const padOk = MockDB.padron.find(p =>
        p.institucionId === institucionId &&
        p.dni === dniNorm &&
        p.activo === true
      );

      if(!padOk){
        return {
          ok:false,
          error: "Ese DNI no corresponde a esta instituci√≥n.\nSi cre√©s que es un error, comunicate con el profe Eber."
        };
      }

      // Unicidad: DNI por instituci√≥n
      const dniExists = MockDB.alumnos.some(a => a.institucionId === institucionId && a.dni === dniNorm);
      if(dniExists){
        return { ok:false, error:"Ese DNI ya tiene una cuenta registrada en esta instituci√≥n." };
      }

      // Unicidad: Alias por instituci√≥n
      const aliasExists = MockDB.alumnos.some(a => a.institucionId === institucionId && a.alias.toLowerCase() === aliasNorm);
      if(aliasExists){
        return { ok:false, error:"Ese alias ya est√° en uso en esta instituci√≥n. Eleg√≠ otro." };
      }

      const newId = "alu-" + Math.random().toString(16).slice(2,10);
      const alumno = {
        id: newId,
        institucionId,
        nombre: nombre.trim(),
        apellido: apellido.trim(),
        dni: dniNorm,
        alias: aliasNorm,
        password,
        activo: true
      };

      MockDB.alumnos.push(alumno);

      return {
        ok:true,
        data: {
          id: alumno.id,
          institucionId: alumno.institucionId,
          nombre: alumno.nombre,
          apellido: alumno.apellido,
          alias: alumno.alias,
          dni: alumno.dni
        }
      };
    }
  };

  /* ============================================================
     APP STATE (persistente)
     ============================================================ */

  const Storage = {
    getSelectedInstitution(){
      return localStorage.getItem("aleph_selectedInstitutionId") || null;
    },
    setSelectedInstitution(id){
      localStorage.setItem("aleph_selectedInstitutionId", id);
    },
    clearSelectedInstitution(){
      localStorage.removeItem("aleph_selectedInstitutionId");
    },
    getSession(){
      const raw = localStorage.getItem("aleph_session");
      return raw ? JSON.parse(raw) : null;
    },
    setSession(session){
      localStorage.setItem("aleph_session", JSON.stringify(session));
    },
    clearSession(){
      localStorage.removeItem("aleph_session");
    }
  };

  const Pages = {
    all: ["home","about","teachers","contact","alumno","auth","settings"],
    show(route){
      for(const r of Pages.all){
        const el = document.getElementById("page-"+r);
        if(!el) continue;
        el.classList.toggle("hidden", r !== route);
      }
      Nav.highlight(route);
    }
  };

  const Nav = {
    go(route){
      Pages.show(route);
      // close dropdown + mobile
      UI.closeProfileMenu();
      Nav.toggleMobile(false);
      // special: if going to alumno, refresh list
      if(route === "alumno") Alumno.renderInstitutions();
      if(route === "settings") Prefs.syncButtons();
    },
    highlight(route){
      document.querySelectorAll('[data-route]').forEach(a => {
        a.classList.toggle("active", a.getAttribute("data-route") === route);
      });
    },
    toggleMobile(force){
      const mm = document.getElementById("mobileMenu");
      const open = typeof force === "boolean" ? force : !mm.classList.contains("open");
      mm.classList.toggle("open", open);
    }
  };

  const UI = {
    setMessage(text, type="info"){
      const box = document.getElementById("authMsg");
      box.classList.remove("hidden","error","success");
      box.classList.add(type === "error" ? "error" : type === "success" ? "success" : "");
      box.textContent = text;
    },
    clearMessage(){
      const box = document.getElementById("authMsg");
      box.classList.add("hidden");
      box.textContent = "";
      box.classList.remove("error","success");
    },
    renderProfile(){
      const area = document.getElementById("profileArea");
      const session = Storage.getSession();

      if(!session){
        area.innerHTML = `
          <button class="btn primary" onclick="Nav.go('alumno')">Ingresar</button>
        `;
        return;
      }

      const display = `${session.alias}`;
      const initials = (session.alias || "A").slice(0,1).toUpperCase();

      area.innerHTML = `
        <div class="dropdown">
          <button class="chip" onclick="UI.toggleProfileMenu()" type="button" aria-label="Abrir perfil">
            <span style="display:grid;place-items:center;width:28px;height:28px;border-radius:10px;border:1px solid var(--border);background:var(--bg);font-weight:900;">${initials}</span>
            <span>
              <span style="display:block;line-height:1.05;">${display}</span>
              <small>${session.nombre} ${session.apellido}</small>
            </span>
          </button>

          <div class="dropdown-panel" id="profileMenu">
            <button type="button" onclick="UI.openProfile()">üë§ Mi perfil</button>
            <button type="button" onclick="Nav.go('settings')">‚öôÔ∏è Configuraci√≥n</button>
            <button type="button" onclick="Auth.logout()">üö™ Cerrar sesi√≥n</button>
          </div>
        </div>
      `;
    },
    toggleProfileMenu(){
      const m = document.getElementById("profileMenu");
      if(!m) return;
      m.classList.toggle("open");
    },
    closeProfileMenu(){
      const m = document.getElementById("profileMenu");
      if(m) m.classList.remove("open");
    },
    openProfile(){
      const s = Storage.getSession();
      if(!s) return;
      alert(
        `Perfil (Mock)\n\n` +
        `Nombre: ${s.nombre} ${s.apellido}\n` +
        `Alias: ${s.alias}\n` +
        `DNI: ${s.dni}\n` +
        `Instituci√≥n ID: ${s.institucionId}\n\n` +
        `Desde ac√° en la app real podr√≠amos mostrar m√°s datos.`
      );
      UI.closeProfileMenu();
    }
  };

  // close dropdown on outside click
  document.addEventListener("click", (e)=>{
    const menu = document.getElementById("profileMenu");
    if(!menu) return;
    const chip = e.target.closest(".chip");
    const panel = e.target.closest(".dropdown-panel");
    if(!chip && !panel) UI.closeProfileMenu();
  });

  const Prefs = {
    setTheme(theme){
      localStorage.setItem("aleph_theme", theme);
      document.documentElement.classList.toggle("dark", theme === "dark");
      Prefs.syncButtons();
    },
    setScale(scale){
      localStorage.setItem("aleph_fontScale", scale);
      document.documentElement.style.setProperty("--font-scale", scale);
      Prefs.syncButtons();
    },
    syncButtons(){
      const t = localStorage.getItem("aleph_theme") || "light";
      const s = localStorage.getItem("aleph_fontScale") || "1";

      const bL = document.getElementById("themeLight");
      const bD = document.getElementById("themeDark");
      if(bL && bD){
        bL.classList.toggle("active", t === "light");
        bD.classList.toggle("active", t === "dark");
      }

      document.querySelectorAll('[data-scale]').forEach(btn=>{
        btn.classList.toggle("active", btn.getAttribute("data-scale") === s);
      });
    }
  };

  const Alumno = {
    async renderInstitutions(){
      const holder = document.getElementById("instCards");
      holder.innerHTML = `
        <div class="panel" style="grid-column:1/-1;">
          <div style="font-weight:900;">Cargando instituciones...</div>
          <div class="muted" style="font-weight:750;">Simulando consulta a la API.</div>
        </div>
      `;

      const list = await MockAPI.institucionesList();
      holder.innerHTML = "";

      list.forEach(inst=>{
        const meta = [inst.ciudad, inst.provincia].filter(Boolean).join(" ‚Ä¢ ");
        const card = document.createElement("div");
        card.className = "card";
        card.setAttribute("role","button");
        card.setAttribute("tabindex","0");
        card.onclick = ()=> Auth.selectInstitution(inst.id);

        card.innerHTML = `
          <div class="logo">
            <img src="${inst.logoUrl || "https://via.placeholder.com/160x160.png?text=Logo"}" alt="Logo ${inst.nombre}" />
          </div>
          <div style="min-width:0;">
            <strong style="font-size:1.02rem;line-height:1.15;">${inst.nombre}</strong>
            <small>${meta || "Instituci√≥n activa"}</small>
          </div>
        `;
        holder.appendChild(card);
      });

      // auto: if there is a selected institution and no session, offer direct continue
      const sel = Storage.getSelectedInstitution();
      const session = Storage.getSession();
      if(sel && !session){
        const inst = await MockAPI.getInstitucion(sel);
        if(inst && inst.activa){
          const hint = document.createElement("div");
          hint.className = "panel";
          hint.style.gridColumn = "1/-1";
          hint.innerHTML = `
            <h2>Continuar</h2>
            <p class="muted">
              Se detect√≥ una instituci√≥n seleccionada anteriormente: <strong>${inst.nombre}</strong>.
            </p>
            <button class="btn primary" onclick="Auth.selectInstitution('${inst.id}')">Continuar con ${inst.nombre}</button>
          `;
          holder.prepend(hint);
        }else{
          Storage.clearSelectedInstitution();
        }
      }
    }
  };

  const Auth = {
    currentInst: null,
    mode: "login",

    async selectInstitution(instId){
      Storage.setSelectedInstitution(instId);
      Auth.currentInst = await MockAPI.getInstitucion(instId);

      document.getElementById("authInstPill").textContent = "üè´ " + Auth.currentInst.nombre;
      document.getElementById("authInstMeta").textContent =
        [Auth.currentInst.ciudad, Auth.currentInst.provincia].filter(Boolean).join(" ‚Ä¢ ");

      Auth.setMode("login");
      UI.clearMessage();
      Pages.show("auth");

      // focus
      setTimeout(()=> document.getElementById("loginIdentifier")?.focus(), 50);
    },

    setMode(mode){
      Auth.mode = mode;
      const isLogin = mode === "login";
      document.getElementById("loginForm").classList.toggle("hidden", !isLogin);
      document.getElementById("registerForm").classList.toggle("hidden", isLogin);

      document.getElementById("authModeTitle").textContent = isLogin ? "Ingresar" : "Crear cuenta";
      document.getElementById("authModeHint").textContent = isLogin
        ? "Ingres√° con DNI o Alias y tu contrase√±a."
        : "Complet√° tus datos. El DNI debe estar precargado por tu instituci√≥n.";

      UI.clearMessage();
    },

    backToInstitutions(){
      Pages.show("alumno");
      Alumno.renderInstitutions();
    },

    async submitLogin(e){
      e.preventDefault();
      UI.clearMessage();

      const institucionId = Auth.currentInst?.id || Storage.getSelectedInstitution();
      const identifier = document.getElementById("loginIdentifier").value.trim();
      const password = document.getElementById("loginPassword").value;

      if(!identifier || !password){
        UI.setMessage("Complet√° DNI/Alias y contrase√±a.", "error");
        return;
      }

      const res = await MockAPI.alumnoLogin({ institucionId, identifier, password });
      if(!res.ok){
        UI.setMessage(res.error, "error");
        return;
      }

      Storage.setSession(res.data);
      UI.renderProfile();
      UI.setMessage("¬°Sesi√≥n iniciada correctamente!", "success");

      // After a short delay go to Home
      setTimeout(()=>{
        Pages.show("home");
        UI.clearMessage();
      }, 650);
    },

    async submitRegister(e){
      e.preventDefault();
      UI.clearMessage();

      const institucionId = Auth.currentInst?.id || Storage.getSelectedInstitution();

      const nombre = document.getElementById("regNombre").value.trim();
      const apellido = document.getElementById("regApellido").value.trim();
      const dni = document.getElementById("regDni").value.trim();
      const alias = document.getElementById("regAlias").value.trim();
      const password = document.getElementById("regPass").value;

      const res = await MockAPI.alumnoRegister({ institucionId, nombre, apellido, dni, alias, password });
      if(!res.ok){
        UI.setMessage(res.error, "error");
        return;
      }

      Storage.setSession(res.data);
      UI.renderProfile();
      UI.setMessage("Cuenta creada y sesi√≥n iniciada.", "success");

      setTimeout(()=>{
        Pages.show("home");
        UI.clearMessage();
      }, 800);
    },

    logout(){
      Storage.clearSession();
      UI.renderProfile();
      Nav.go("home");
      alert("Sesi√≥n cerrada (Mock).");
    }
  };

  /* ============================================================
     INIT
     ============================================================ */

  function hideSplash(){
    const s = document.getElementById("splash");
    s.style.opacity = "0";
    s.style.transition = "opacity .25s ease";
    setTimeout(()=> s.remove(), 260);
  }

  window.addEventListener("load", async ()=>{
    // splash duration: ~1.35s
    setTimeout(hideSplash, 1350);

    // render profile
    UI.renderProfile();

    // default route
    Pages.show("home");
    Prefs.syncButtons();

    // if session exists, keep
    // else nothing
  });
</script>

</body>
</html>
